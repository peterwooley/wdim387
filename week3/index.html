<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <title>WDIM387 Advanced Scripting &mdash; Week 3</title>
        <!-- Slippy core file and dependencies -->
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
        <script type="text/javascript" src="slippy/src/jquery.history.js"></script>
        <script type="text/javascript" src="slippy/src/slippy.js"></script>
        <!-- Slippy structural styles -->
        <link type="text/css" rel="stylesheet" href="slippy/src/slippy.css"/>
        <!-- Syntax highlighting core file  -->
        <script type="text/javascript" src="slippy/src/highlighter/shCore.js"></script>
        <!-- Syntax highlighting brushes, remove those you don't need -->
        <script type="text/javascript" src="slippy/src/highlighter/shBrushBash.js"></script>
        <script type="text/javascript" src="slippy/src/highlighter/shBrushCss.js"></script>
        <script type="text/javascript" src="slippy/src/highlighter/shBrushDiff.js"></script>
        <script type="text/javascript" src="slippy/src/highlighter/shBrushJScript.js"></script>
        <script type="text/javascript" src="slippy/src/highlighter/shBrushPhp.js"></script>
        <script type="text/javascript" src="slippy/src/highlighter/shBrushPlain.js"></script>
        <script type="text/javascript" src="slippy/src/highlighter/shBrushXml.js"></script>
        <!-- Syntax highlighting styles-->
        <link type="text/css" rel="stylesheet" href="slippy/src/highlighter/shCore.css"/>
        <link type="text/css" rel="stylesheet" href="slippy/src/highlighter/shThemeRDark.css"/>


		<!-- Common Styles -->
		<link href="http://fonts.googleapis.com/css?family=Terminal+Dosis+Light:regular&v1" rel="stylesheet" type="text/css" >
		<link type="text/css" rel="stylesheet" href="styles/slippy-wdim.css" />

        <!-- Slippy init code -->
        <script type="text/javascript">
            $(function() {
                $(".slide").slippy();
				SyntaxHighlighter.defaults.gutter = false;
                SyntaxHighlighter.all();
            });
        </script>

        <!-- Custom style for this deck -->
        <style type="text/css">
            .slide.nofooter {
                border: 0;
                background: 0;
            }
        </style>
    </head>
    <body>
        <div class="slide title" data-layout="title">
            <h1>WDIM387 Advanced Scripting</h1>
			<h2>Week 3</h2>
        </div>

		<div class="slide title">
			<h1>How'd the Homework go?</h1>
			<h2>Email the Live URL and GitHub Repo URL to <a href="mailto:pwooley@aii.edu">pwooley@aii.edu</a>.</h2> 
		</div>

		<div class="slide">
		    <h1>Weekly Happenings</h1>
			<ul>
				<li>Firebug allows you to <a href="http://www.sitepoint.com/firebug-css-active-hover-states/">examine :active &amp; :hover styles</a>.</li>
				<li>Nathan Whitehead has <a href="http://nathansjslessons.appspot.com/">some great JavaScript tutorials</a> (<abbr title="Hat Tip">HT</abbr> <a href="http://twitter.com/phyre5">@phyre5</a>).</li>
				<li>ThinkGeek will be selling <a href="http://twitpic.com/5twcii">a Plush Talking Portal Turret</a> this winter.</li>
				<li>I spent (well, McAfee spent) $500 dollars on an IDE (<a href="http://www.jetbrains.com/idea/">Intellij IDEA</a>).</a>
		</div>

		<div class="slide">
			<h1>Strategy Design Pattern</h1>
			<p>The strategy pattern defines a family of algorithms, encapsulates each one, and makes them interchangeable.</p>
			<pre class="brush: js">// This code demonstrates the pattern, but doesn't quite work.
// JavaScript date and number formatting isn't quite this nice.
var formatStrategies = {
	enUS: { 
		date: function(d) { return d.toString("dd/MM/yyyy"); },
		number: function(n) { return lib.addDelimiters(n, ","); }
	},
	enGB: {
		date: function(d) { return d.toString("MM/dd/yyyy"); }, 
		number: function(n) { return lib.addDelimiters(n, "."); }
	}
};

// When the user logs in, set this value.
var format = formatStrategies.enGB;

format.date(new Date); // Returns 06/30/2011
format.number("12000345.28"); // Returns 12.000.345,28
</pre>
		</div>

		<div class="slide">
			<h1>Design Pattern Researchathon</h1>
			<p>You've got 30 minutes to learn about and implement a Design Pattern &mdash; <em>that we haven't discussed</em> &mdash; in JavaScript.</p>
			<p>The Creational and Structural Patterns are easier, but <a href="http://en.wikipedia.org/wiki/Design_pattern_%28computer_science%29">go ahead and pick any one you'd like</a>!</p>
		</div>

		<div class="slide">
			<h1>Debugging Everywhere</h1>
			<p>Essential tools for debugging server- and client-side code:</p>
			<ul>
				<li>Browser-based JavaScript Debugger (Firebug, F12 Tools, Web Inspector)</li>
				<li>Browser-based Network Traffic Monitor</li>
				<li><a href="http://www.firephp.org/">FirePHP</a> (and <a href="http://www.firephp.org/Wiki/Libraries/Ruby">FirePHRuby</a>)</li>
			</ul>
		</div>

		<div class="slide">
			<h1>Why Ajax?</h1>
			<ol>
				<li>Above all, to Benefit the User Experience.</li>
				<li>To update the UI without refreshing the page.</li>
				<li>To interact with Web Services without using the server.</li>
				<li>To reduce strain on the server. (Just send JSON, no HTML)</li>
				<li>To be hip/cool/stylin'/bitchin'/etc.</li>
			</ol>
		</div>

		<div class="slide">
			<h1>7 Ajax Best Practices</h1>
			<ol>
				<li>If possible, make Ajax an optional enhancement to your <abbr title="User Experience">UX</a>.</li>
				<li>Send and expect data (JSON, YAML, XML) from the server.</li>
				<li>Make the data as tiny as possible.</li>
				<li>Unless it's impractical, have JavaScript widgets construct their own DOM Structures.</li>
				<li>Handle errors elegantly.</li>
				<li>Don't break the Back button.</li>
				<li>Learn about HTTP (and TCP/IP).</li>
			</ol>
		</div>

		<div class="slide">
			<h1>Make Ajax Optional</h1>
			<p>GitHub makes use of the new HTML5 <code>history.pushState()</code> method to update (and animate!) the page as users drill down into repositories.</p>
			<pre class="brush: js">// Setup buttons to slide instead of click.
$("#slider a.js-slide-to, .breadcrumb a").live("click", function (event) {
	event.preventDefault();
	window.history.pushState({}, '', a.target.href);
})

// When the state changes, slide the new page into view.
$(window).bind("popstate", function(event) {
	AwesomeGitHubSlider.slideTo(location.pathname);
});</pre>
		</div>

		<div class="slide">
			<h1>Send &amp; Expect Data from the Server</h1>
			<p>Using Ajax can reduce the number of bits that flow between the server and the browser.</p>
			<p>Send data (JSON) to the server and have the server return data, rather than rendered markup.</p>
			<p>JavaScript is fast, and getting faster, so writing your DOM construction code on the client-side can save your server cycles.</p>
			<p>Plus, you can manipulate data easily in JavaScript. Doing post-processing on an HTML block in JavaScript is a little trickier.</p>
		</div>

		<div class="slide">
			<h1>Make Data as Tiny as Possible</h1>
			<ul>
				<li>When sending and recieving data, make sure it's as small as possible.</li>
				<li>Favor JSON over XML.</li>
				<li>If it makes sense to just return a string, then just return a string.</li>
				<li><a href="http://developer.yahoo.com/performance/rules.html#gzip">Use gzip compression</a> on your entire site to reduce the size further.</li>
			</ul>
		</div>

		<div class="slide">
			<h1>Widgets Should Construct their Elements</h1>
			<p>Do this:</p>
			<pre class="brush: js">var TableWidget = {
	render: function(rows) {
		var $el = $("<table><thead><tr><th>Name</th></tr></thead><tbody></tbody></table>");
		// Add data to table here
		$el.appendTo("body");
	}
}</pre>
			<p>Not this:</p>
			<pre class="brush: js">&lt;table id="tablewidget"&gt;
	&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Name&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;
	&lt;tbody&gt;&lt;/tbody&gt;
&lt;/table&gt;
&lt;script&gt;
	var TableWidget = {
		render: function(rows) {
			var $el = $("#tableWidget");
			// Add data to table here
		}
	}
&lt;/script&gt;</pre>
		</div>

		<div class="slide">
			<h1>Handle Errors Elegantly</h1>
			<p>Make sure to utilize error handlers when your server or Web Service is unavailable or times out.</p>
			<pre class="brush: js">$.getJSON("http://server/api/data.json")
	.done(function(data) { alert("Success!"); })
	.fail(function(error) { alert("FAIL! Refresh the page?"); });
</pre>
		</div>

		<div class="slide">
			<h1>Don't Break the Back Button</h1>
			<p><a href="http://net.tutsplus.com/tutorials/javascript-ajax/24-best-practices-for-ajax-implementations/">Nettuts+ says it well</a>:
			<blockquote>
				<h2>Respect the Back Button</h2>
				<p>The back button is another action that has become part of a normal web user’s habits. Make sure your application adheres to this respected paradigm to avoid angering users. Trust me, they will, if suddenly their back button doesn’t work as intended.</p>
				<p>Here is a list of article which should help you with the matter.</p>
				<ul>
					<li><a href=http://www.contentwithstyle.co.uk/content/fixing-the-back-button-and-enabling-bookmarking-for-ajax-apps>Content with Style</a></li>
					<li><a href="http://www.mikage.to/jquery/jquery_history.html">jQuery History Plugin</a></li>
					<li><a href="http://code.google.com/p/reallysimplehistory/">Really Simple History</a></li>
				</ul>
			</blockquote>
		</div>

		<div class="slide">
			<h1>Learn about HTTP &amp; TCP/IP</h1>
			<p>Read these books:</p>
			<ul>
				<li><a href="http://amzn.com/1565925092">HTTP: The Definitive Guide</a></li>
				<li>
				    <a href="http://amzn.com/0201633469">TCP/IP Illustrated</a>
				</li>
		</div>

		<div class="slide">
			<h1><a href="http://cutetypo.com">CuteTypo</a> &mdash; A Chat Web Service</h1>
			<p><a href="http://cutetypo.com">CuteTypo</a> <del>is</del> <ins>will be</ins> a Web-based Chat Service.</p>
			<p>It'll provide everything for a Chat Application, save for the front-end.</p>
			<p>It'll be the topic of both our in-class Hackathon and our Homework for next week.</p>
			<p><a href="http://github.com/peterwooley/cutetypo">The source is available on GitHub.</a></p>
		</div>

		<div class="slide">
			<h1>Canvas</h1>
			<p>The canvas tag is a scriptable drawing API (Like Flash, but <del>slower</del> <ins>better</ins>).</p>
			<pre class="brush: html">&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
&lt;head&gt;
	&lt;title&gt;Canvas!&lt;/title&gt;
	&lt;script&gt;
	window.onload = function() {
		var stage = document.getElementById("stage");

		// Get the Canvas context
		// Will throw an error when unsupported.
		var ctx = stage.getContext('2d');

		ctx.fillStyle = "rgb(200,0,0)";
		ctx.fillRect(10, 10, 55, 50);
		ctx.fillStyle = "rgba(0, 0, 200, 0.5)";
		ctx.fillRect(30, 30, 55, 50);
	};
	&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;canvas id="stage" width="300" height="200"&gt;&lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
		</div>
	
		<div class="slide">
			<h1>Drawing Lines</h1>
			<p>Canvas offers methods to draw contiguous and non-contiguous lines and curves.</li>
			<pre class="brush: js">// Draws a Triangle
ctx.beginPath(); // Creates a new path
ctx.moveTo(75,50); // Moves the path without drawing a line.
ctx.lineTo(100,75); // Draws a line from 75,50 to 100,75
ctx.lineTo(100,25);
ctx.lineTo(75,50); 
ctx.stroke(); // Makes the line visible

// Draws a Pac-like Man
ctx.beginPath(); // Starts a brand new path
ctx.moveTo(200, 50); // Move to center of circle
ctx.arc(200,50,30,Math.PI*.15,Math.PI*1.85); // Radians
ctx.lineTo(200,50); // Finish in center
ctx.stroke(); // Add line
ctx.fillStyle = "yellow";
ctx.fill(); // Fill shape with color 
</pre>
		</div>

		<div class="slide">
			<h1>Happyhackathon</h1>
			<p>You have 15 minutes to use the canvas tag to draw a smiley face.</p>
			<p>You can use any methods as long as it looks like a face!</p>
		</div>

		<div class="slide">
			<h1>Using Images</h1>
			<p>Canvas provides a <code>drawImage()</code> method that allows us to place images within our canvas.</p>
			<pre class="brush: js">var img = new Image();
img.onload = function() {
	ctx.drawImage(img, 0, 0);
	ctx.strokeStyle = "#fff";
	ctx.lineWidth = 2;
	ctx.strokeRect(10,10,280,180);
}
img.src = "http://placekitten.com/300/200";</pre>
			<p>Read more about using images in canvas at <a href="https://developer.mozilla.org/en/Canvas_tutorial%3aUsing_images">Mozilla's Canvas Tutorial</a>.</p>
		</div>

		<div class="slide">
			<h1>Rotation, Translation &amp; Scaling</h1>
			<p><code>rotate()</code>, <code>translate()</code>, <code>scale()</code>, <code>save()</code>, and <code>restore()</code> require an example.</p>
			<pre class="brush: js">var ctx = stage.getContext('2d'),	
	img = new Image(),
	rad = 0; // The current rotation in Radians

img.onload = function() {
	setInterval(function() {
		rad += rad < Math.PI*2 ? .1 : -rad + .1;
		ctx.clearRect(0,0,300,200);
		ctx.save();
		ctx.translate(150, 100); // Set 0,0 to Center
		ctx.rotate(rad);
		// ctx.scale(rad, rad); // This will hurt.
		ctx.drawImage(img, -150, -100);
		ctx.strokeStyle = "#fff";
		ctx.lineWidth = 2;
		ctx.strokeRect(-140,-90,280,180);
		ctx.restore();

	}, 50); // Re-render the canvas every 50ms`
}
img.src = "http://placekitten.com/300/200";</pre>
			<p>Futher details are in the <a href="https://developer.mozilla.org/en/Canvas_tutorial/Transformations">Mozilla Tutorial</a>.</p>
		</div>

		<div class="slide">
		    <h1>Interacting with the User</h1>
			<p>Since the canvas tag is essentially an image, interacting with the mouse requires a little bit more work than you would assume.</p>
		    <pre class="brush: js">window.onload = function() {
	var stage = document.getElementById("stage");
	// Get the Canvas context
	var ctx = stage.getContext('2d');

	stage.onclick = function(event) {
		// Determine the mouse position, relative to the canvas.
		var x = event.clientX - stage.offsetLeft,
			y = event.clientY - stage.offsetTop;

		ctx.clearRect(0,0,300,200);
		// Draw a rectangle centered on the mouse position
		ctx.fillRect(x-5, y-5, 10, 10);
	};
};</pre>
		</div>

		<div class="slide">
		    <h1>Click &amp; Spinathon</h1>
		    <p>You've got 15 minutes to combine the Rotation example with the Interaction example.</p>
			<p>Allow the user to click on any part of the canvas and move the spinning image so it is centered on the mouse location.</p>
			<p>Bonus Participation Point: When the user clicks, slide (read: animate) the image (as it's spinning) to the new location.</p>
		</div>

		<div class="slide">
		    <h1>An Example Planet</h1>
		    <p>I have a fairly complex example of <a href="examples/planet/canvas.html">an animating canvas drawing</a>.</p>
			<p>We'll walk through it and see what makes sense.</p>
		</div>

		<div class="slide title">
			<h1>Done &amp; Done</h1>
			<h2><a href="homework.html">Homework!</a></h2>
		</div>

        <div class="layout" data-name="title">
            <content></content>
            <div class="footer">
                <span class="left">Peter Wooley</span>
                <span class="right">WDIM387A</span>
                <span class="left">Twitter <a href="http://twitter.com/peterwooley">@peterwooley</a></span>
                <span class="right"><a href="https://github.com/peterwooley/wdim387">Notes on GitHub</a></span>
                <hr class="defloat" />
            </div>
        </div>

        <div class="layout nofooter" data-name="default">
            <content></content>
        </div>
    
		<!-- Common Scripts -->
		<script src="scripts/jquery.noisy.min.js"></script>
		<script src="scripts/index.js"></script>
	</body>
</html>
